<!-- Product Page -->
<div style="max-width: 1200px; margin: 0 auto; padding: 2rem 1.5rem;">
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 3rem;">

    <!-- Main Image -->
    <div style="position: relative;">
      <div style="aspect-ratio: 1; border-radius: var(--radius-lg); overflow: hidden; background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%); box-shadow: var(--shadow-xl);">
        {% if product.featured_image %}
          <img
            src="{{ product.featured_image | img_url: '800x800' }}"
            alt="{{ product.featured_image.alt | default: product.title }}"
            id="main-image"
            style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;"
            onmouseover="this.style.transform='scale(1.05)'"
            onmouseout="this.style.transform='scale(1)'"
          >
        {% else %}
          <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#d97706" stroke-width="1">
              <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
              <circle cx="9" cy="9" r="2"/>
              <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
            </svg>
          </div>
        {% endif %}
      </div>

      <!-- Image Thumbnails -->
      {% if product.images.size > 1 %}
        <div style="display: flex; gap: 0.75rem; margin-top: 1rem; overflow-x: auto; padding-bottom: 0.5rem;">
          {% for image in product.images %}
            <button
              onclick="document.getElementById('main-image').src='{{ image | img_url: '800x800' }}'"
              style="flex-shrink: 0; width: 80px; height: 80px; border-radius: var(--radius-sm); overflow: hidden; border: 2px solid transparent; cursor: pointer; transition: all 0.2s ease;"
              onmouseover="this.style.borderColor='var(--color-primary)'; this.style.transform='scale(1.05)'"
              onmouseout="this.style.borderColor='transparent'; this.style.transform='scale(1)'"
            >
              <img
                src="{{ image | img_url: '100x100' }}"
                alt="{{ image.alt | default: product.title }}"
                style="width: 100%; height: 100%; object-fit: cover;"
              >
            </button>
          {% endfor %}
        </div>
      {% endif %}

      <!-- Badges -->
      <div style="position: absolute; top: 1rem; left: 1rem; display: flex; flex-direction: column; gap: 0.5rem;">
        {% unless product.available %}
          <span class="badge badge-sale">Sold Out</span>
        {% endunless %}
        {% if product.compare_at_price > product.price %}
          <span class="badge badge-sale">
            {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}% OFF
          </span>
        {% endif %}
      </div>
    </div>

    <!-- Product Info -->
    <div>
      <!-- Breadcrumb -->
      <nav style="margin-bottom: 1.5rem;">
        <a href="/" style="color: var(--color-text-muted); text-decoration: none; font-size: 0.875rem;">Home</a>
        <span style="color: var(--color-text-muted); margin: 0 0.5rem;">/</span>
        {% if collection %}
          <a href="{{ collection.url }}" style="color: var(--color-text-muted); text-decoration: none; font-size: 0.875rem;">{{ collection.title }}</a>
          <span style="color: var(--color-text-muted); margin: 0 0.5rem;">/</span>
        {% endif %}
        <span style="color: var(--color-primary-dark); font-size: 0.875rem; font-weight: 600;">{{ product.title | truncate: 30 }}</span>
      </nav>

      <!-- Vendor -->
      <p class="product-vendor" style="font-size: 0.85rem;">{{ product.vendor }}</p>

      <!-- Title -->
      <h1 style="font-size: 2rem; font-weight: 800; color: var(--color-text); margin-bottom: 1rem; line-height: 1.2;">
        {{ product.title }}
      </h1>

      <!-- Price -->
      <div style="display: flex; align-items: baseline; gap: 1rem; margin-bottom: 1.5rem;">
        <span style="font-size: 2.5rem; font-weight: 900; background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
          {{ product.price | money }}
        </span>
        {% if product.compare_at_price > product.price %}
          <span style="font-size: 1.25rem; color: var(--color-text-muted); text-decoration: line-through;">
            {{ product.compare_at_price | money }}
          </span>
        {% endif %}
      </div>

      <!-- Tags -->
      {% if product.tags.size > 0 %}
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem;">
          {% for tag in product.tags %}
            <span class="product-tag" style="padding: 0.375rem 0.875rem;">{{ tag }}</span>
          {% endfor %}
        </div>
      {% endif %}

      <!-- Variant Selector -->
      {% if product.variants.size > 1 %}
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--color-text);">
            {{ product.options.first }}
          </label>
          <select
            id="variant-selector"
            style="width: 100%; padding: 0.875rem 1rem; border: 2px solid rgba(245, 158, 11, 0.2); border-radius: var(--radius-md); font-size: 1rem; background: white; cursor: pointer;"
          >
            {% for variant in product.variants %}
              <option value="{{ variant.id }}" {% unless variant.available %}disabled{% endunless %}>
                {{ variant.title }}{% unless variant.available %} - Sold Out{% endunless %}
              </option>
            {% endfor %}
          </select>
        </div>
      {% endif %}

      <!-- Add to Cart Form -->
      <form action="/cart/add" method="post" id="product-form" style="margin-bottom: 2rem;">
        <input type="hidden" name="id" value="{{ product.variants.first.id }}" id="variant-id">

        <!-- Quantity and Add Button -->
        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
          <div style="display: flex; align-items: center; border: 2px solid rgba(245, 158, 11, 0.2); border-radius: var(--radius-md); overflow: hidden;">
            <button type="button" onclick="updateQuantity(-1)" style="padding: 0.875rem 1rem; background: none; border: none; cursor: pointer; font-size: 1.25rem; color: var(--color-primary);">-</button>
            <input type="number" name="quantity" value="1" min="1" id="quantity-input" style="width: 60px; text-align: center; border: none; font-size: 1rem; font-weight: 600;">
            <button type="button" onclick="updateQuantity(1)" style="padding: 0.875rem 1rem; background: none; border: none; cursor: pointer; font-size: 1.25rem; color: var(--color-primary);">+</button>
          </div>

          {% if product.available %}
            <button type="submit" class="add-to-cart-btn" style="flex: 1; padding: 1rem 2rem; font-size: 1.1rem;">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/>
                <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
              </svg>
              Add to Cart
            </button>
          {% else %}
            <button type="button" disabled style="flex: 1; padding: 1rem 2rem; font-size: 1.1rem; background: #9ca3af; color: white; border: none; border-radius: var(--radius-md); cursor: not-allowed;">
              Sold Out
            </button>
          {% endif %}
        </div>
      </form>

      <!-- Description -->
      {% if product.description != blank %}
        <div style="border-top: 1px solid rgba(245, 158, 11, 0.1); padding-top: 1.5rem;">
          <h3 style="font-weight: 700; margin-bottom: 1rem; color: var(--color-text);">Description</h3>
          <div style="color: var(--color-text-muted); line-height: 1.8;">{{ product.description }}</div>
        </div>
      {% endif %}

      <!-- Product Details -->
      <div style="border-top: 1px solid rgba(245, 158, 11, 0.1); padding-top: 1.5rem; margin-top: 1.5rem;">
        <h3 style="font-weight: 700; margin-bottom: 1rem; color: var(--color-text);">Details</h3>
        <ul style="list-style: none; color: var(--color-text-muted);">
          <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
            <span>Vendor</span>
            <span style="font-weight: 600; color: var(--color-text);">{{ product.vendor }}</span>
          </li>
          <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
            <span>Type</span>
            <span style="font-weight: 600; color: var(--color-text);">{{ product.type | default: 'N/A' }}</span>
          </li>
          <li style="display: flex; justify-content: space-between; padding: 0.5rem 0;">
            <span>Availability</span>
            <span style="font-weight: 600; color: {% if product.available %}#10b981{% else %}#ef4444{% endif %};">
              {% if product.available %}In Stock{% else %}Out of Stock{% endif %}
            </span>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
  function updateQuantity(change) {
    const input = document.getElementById('quantity-input');
    const newValue = Math.max(1, parseInt(input.value) + change);
    input.value = newValue;
  }

  const variantSelector = document.getElementById('variant-selector');
  if (variantSelector) {
    variantSelector.addEventListener('change', function() {
      document.getElementById('variant-id').value = this.value;
    });
  }
</script>
