<!-- Cart Page -->
<div style="max-width: 1000px; margin: 0 auto; padding: 2rem 1.5rem;">
  <h1 class="hero-title" style="text-align: center; margin-bottom: 2rem;">
    <span class="gradient-text">Your Cart</span>
  </h1>

  {% if cart.item_count > 0 %}
    <div style="display: grid; gap: 2rem;">
      <!-- Cart Items -->
      <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); overflow: hidden;">
        {% for item in cart.items %}
          <div style="display: flex; gap: 1.5rem; padding: 1.5rem; border-bottom: 1px solid rgba(245, 158, 11, 0.1); {% if forloop.last %}border-bottom: none;{% endif %}">
            <!-- Image -->
            <a href="{{ item.url }}" style="flex-shrink: 0;">
              <img
                src="{{ item.image | img_url: '150x150' }}"
                alt="{{ item.title }}"
                style="width: 120px; height: 120px; object-fit: cover; border-radius: var(--radius-md);"
              >
            </a>

            <!-- Details -->
            <div style="flex: 1; display: flex; flex-direction: column; justify-content: space-between;">
              <div>
                <p class="product-vendor">{{ item.product.vendor }}</p>
                <h3 style="font-weight: 700; font-size: 1.1rem; margin-bottom: 0.25rem;">
                  <a href="{{ item.url }}" style="text-decoration: none; color: var(--color-text);">{{ item.product.title }}</a>
                </h3>
                {% unless item.product.has_only_default_variant %}
                  <p style="color: var(--color-text-muted); font-size: 0.875rem;">{{ item.variant.title }}</p>
                {% endunless %}
              </div>

              <div style="display: flex; align-items: center; gap: 1rem; margin-top: 1rem;">
                <!-- Quantity -->
                <div style="display: flex; align-items: center; border: 2px solid rgba(245, 158, 11, 0.2); border-radius: var(--radius-md); overflow: hidden;">
                  <button
                    onclick="updateCartItem({{ item.key | json }}, {{ item.quantity | minus: 1 }})"
                    style="padding: 0.5rem 0.75rem; background: none; border: none; cursor: pointer; font-size: 1rem; color: var(--color-primary);"
                  >-</button>
                  <span style="padding: 0.5rem 1rem; font-weight: 600;">{{ item.quantity }}</span>
                  <button
                    onclick="updateCartItem({{ item.key | json }}, {{ item.quantity | plus: 1 }})"
                    style="padding: 0.5rem 0.75rem; background: none; border: none; cursor: pointer; font-size: 1rem; color: var(--color-primary);"
                  >+</button>
                </div>

                <!-- Remove -->
                <button
                  onclick="updateCartItem({{ item.key | json }}, 0)"
                  style="background: none; border: none; color: #ef4444; cursor: pointer; font-size: 0.875rem; font-weight: 600;"
                >
                  Remove
                </button>
              </div>
            </div>

            <!-- Price -->
            <div style="text-align: right;">
              <span style="font-size: 1.25rem; font-weight: 800; background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                {{ item.line_price | money }}
              </span>
              {% if item.quantity > 1 %}
                <p style="color: var(--color-text-muted); font-size: 0.75rem;">{{ item.price | money }} each</p>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Cart Summary -->
      <div style="background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); padding: 2rem;">
        <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 1rem;">
          <span style="font-size: 1.125rem; font-weight: 600;">Subtotal</span>
          <span style="font-size: 2rem; font-weight: 900; background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
            {{ cart.total_price | money }}
          </span>
        </div>

        <p style="color: var(--color-text-muted); font-size: 0.875rem; margin-bottom: 1.5rem;">
          Shipping and taxes calculated at checkout.
        </p>

        <!-- Special Instructions -->
        <div style="margin-bottom: 1.5rem;">
          <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.875rem;">Order Notes (optional)</label>
          <textarea
            name="note"
            form="cart-form"
            style="width: 100%; padding: 0.75rem 1rem; border: 2px solid rgba(245, 158, 11, 0.2); border-radius: var(--radius-md); font-size: 0.875rem; resize: vertical; min-height: 80px;"
            placeholder="Any special requests?"
          >{{ cart.note }}</textarea>
        </div>

        <form id="cart-form" action="/cart" method="post">
          <button
            type="submit"
            name="checkout"
            class="checkout-btn"
            style="width: 100%; padding: 1.25rem 2rem; font-size: 1.1rem;"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="20" height="14" x="2" y="5" rx="2"/>
              <line x1="2" x2="22" y1="10" y2="10"/>
            </svg>
            Checkout - {{ cart.total_price | money }}
          </button>
        </form>

        <a href="/collections/all" style="display: block; text-align: center; margin-top: 1rem; color: var(--color-primary-dark); font-weight: 600; text-decoration: none;">
          Continue Shopping
        </a>
      </div>
    </div>
  {% else %}
    <!-- Empty Cart -->
    <div style="text-align: center; padding: 4rem 1rem; background: white; border-radius: var(--radius-lg); box-shadow: var(--shadow-md);">
      <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="rgba(245, 158, 11, 0.3)" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" style="margin-bottom: 1.5rem;">
        <circle cx="8" cy="21" r="1"/>
        <circle cx="19" cy="21" r="1"/>
        <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
      </svg>
      <h2 style="font-size: 1.5rem; font-weight: 800; color: var(--color-text); margin-bottom: 0.5rem;">Your cart is empty</h2>
      <p style="color: var(--color-text-muted); margin-bottom: 2rem;">Looks like you haven't added anything yet.</p>
      <a href="/collections/all" class="add-to-cart-btn" style="display: inline-flex; padding: 1rem 2rem; text-decoration: none;">
        Start Shopping
      </a>
    </div>
  {% endif %}
</div>

<script>
  async function updateCartItem(key, quantity) {
    try {
      const response = await fetch('/cart/change.js', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id: key, quantity: quantity })
      });

      if (response.ok) {
        window.location.reload();
      }
    } catch (error) {
      console.error('Update cart error:', error);
    }
  }
</script>
