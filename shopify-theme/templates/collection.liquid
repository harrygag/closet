<!-- Collection Hero -->
<section class="hero" style="padding: 2rem 1.5rem;">
  <h1 class="hero-title">
    <span class="gradient-text">{{ collection.title }}</span>
  </h1>
  {% if collection.description != blank %}
    <p class="hero-subtitle">{{ collection.description }}</p>
  {% endif %}
  <p style="color: var(--color-text-muted); font-size: 0.9rem; margin-top: 0.5rem;">
    {{ collection.products_count }} {% if collection.products_count == 1 %}item{% else %}items{% endif %}
  </p>
</section>

<!-- Products Grid -->
<section class="products-section">
  {% if collection.products.size > 0 %}
    <div class="products-grid">
      {% for product in collection.products %}
        <article class="product-card" style="animation-delay: {{ forloop.index | times: 0.05 }}s;">
          <div class="product-image-container">
            {% if product.featured_image %}
              <img
                src="{{ product.featured_image | img_url: '500x500', crop: 'center' }}"
                alt="{{ product.featured_image.alt | default: product.title }}"
                class="product-image"
                loading="lazy"
              >
            {% else %}
              <div class="product-image" style="background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%); display: flex; align-items: center; justify-content: center;">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#d97706" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                  <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
                  <circle cx="9" cy="9" r="2"/>
                  <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                </svg>
              </div>
            {% endif %}

            <!-- Badges -->
            <div class="product-badges">
              {% if product.created_at > 'now' | date: '%s' | minus: 604800 | date: '%Y-%m-%d' %}
                <span class="badge badge-new">New</span>
              {% endif %}
              {% if product.compare_at_price > product.price %}
                <span class="badge badge-sale">Sale</span>
              {% endif %}
            </div>

            <!-- Wishlist Button -->
            <button class="product-wishlist" aria-label="Add to wishlist">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
              </svg>
            </button>

            <!-- Sold Out Overlay -->
            {% unless product.available %}
              <div class="product-sold-overlay">
                <span class="sold-badge">Sold Out</span>
              </div>
            {% endunless %}

            <!-- Quick View -->
            <a href="{{ product.url }}" class="quick-view-btn">Quick View</a>
          </div>

          <div class="product-content">
            <p class="product-vendor">{{ product.vendor }}</p>
            <h3 class="product-title">
              <a href="{{ product.url }}">{{ product.title }}</a>
            </h3>

            <!-- Tags -->
            <div class="product-tags">
              {% for tag in product.tags limit: 3 %}
                <span class="product-tag">{{ tag }}</span>
              {% endfor %}
            </div>

            <div class="product-footer">
              <div class="product-price">
                {% if product.compare_at_price > product.price %}
                  <span class="price-original">{{ product.compare_at_price | money }}</span>
                {% endif %}
                <span class="price-current">{{ product.price | money }}</span>
              </div>

              {% if product.available %}
                <button
                  class="add-to-cart-btn"
                  data-variant-id="{{ product.variants.first.id }}"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="8" cy="21" r="1"/>
                    <circle cx="19" cy="21" r="1"/>
                    <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/>
                  </svg>
                  Add
                </button>
              {% else %}
                <button class="add-to-cart-btn" disabled style="opacity: 0.5; cursor: not-allowed;">
                  Sold Out
                </button>
              {% endif %}
            </div>
          </div>
        </article>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if paginate.pages > 1 %}
      <nav style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 3rem;">
        {% if paginate.previous %}
          <a href="{{ paginate.previous.url }}" class="nav-link">Previous</a>
        {% endif %}

        {% for part in paginate.parts %}
          {% if part.is_link %}
            <a href="{{ part.url }}" class="nav-link">{{ part.title }}</a>
          {% else %}
            {% if part.title == paginate.current_page %}
              <span class="nav-link active">{{ part.title }}</span>
            {% else %}
              <span class="nav-link" style="opacity: 0.5;">{{ part.title }}</span>
            {% endif %}
          {% endif %}
        {% endfor %}

        {% if paginate.next %}
          <a href="{{ paginate.next.url }}" class="nav-link">Next</a>
        {% endif %}
      </nav>
    {% endif %}
  {% else %}
    <div style="text-align: center; padding: 4rem 1rem;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">üîç</div>
      <h2 style="color: var(--color-text); margin-bottom: 0.5rem;">No products found</h2>
      <p style="color: var(--color-text-muted);">This collection is empty. Check back soon!</p>
      <a href="/" class="nav-link active" style="display: inline-block; margin-top: 1.5rem;">Back to Home</a>
    </div>
  {% endif %}
</section>
